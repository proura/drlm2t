  
nets:
- name: net1
  ip: 192.168.181.1

hosts:
## DRLM SERVER ##
- name: srv1
  template: deb10
  nets:
  - name: net1
    ip: 192.168.181.2
  tests:
  # host: srv1 - test: 1
  # Update DRLM server making apt update & apt upgrade
  - name: update
    testtype: 1
    filetorun: update.test
  # host: srv1 - test: 2
  # install DRLM feature/incremental_backups of proura GitHub repository
  - name: installDRLM240
    testtype: 1
    filetorun: installCustomDRLM240.test
    args: [ 'https://github.com/proura/drlm', 'develop', 'drlm_2.4.0_all.deb' ]
  # host: srv1 - test: 3
  # Add backup networt to drlm networks in order to do PXE recovers
  - name: addNetwork
    testtype: 1
    commandtorun: "drlm -vD addnetwork -n BuLan -s 192.168.181.2  -m 255.255.255.0 -g 192.168.181.1"
  # host: srv1 - test: 4
  # Install Expect to automate responses of DRLM install client
  - name: installExpect
    testtype: 1
    commandtorun: "apt-get -y install expect"
  # host: srv1 - test: 5
  # Add client 1 - Debian 10 client
  - name: addCli1
    testtype: 1
    filetorun: installClient.test
    args: [ 'deb10cli', '192.168.181.53/24']
    dependencies:
    - host: cli1
      test: 1
  # host: srv1 - test: 6
  # get output of drlm listclient
  - name: listClients
    testtype: 1
    commandtorun: "drlm listclient"

## DRLM CLIENT ##
- name: cli1
  template: deb10
  nets:
  - name: net1
    ip: 192.168.181.53
  tests:
  # host: deb10 - test: 1
  - name: update
    filetorun: update.test
    expect: "OK"
  # host: deb10 - test: 2
  - name: prepareRescue
    filetorun: prepRescueCLI.test
    testtpe: 1
    dependencies:
    - host: srv1
      test: 5 
